apiVersion: apps/v1
kind: Deployment
metadata:
  name: whisper-gpu
  namespace: dev-whisper
spec:
  template:
    spec:
      # Remove GPU-specific configurations
      nodeSelector: {}
      tolerations: []
      runtimeClassName: null
      
      containers:
      - name: whisper
        # Use CPU-based whisper image
        image: rhasspy/wyoming-whisper:latest
        
        # Add command arguments for CPU whisper
        command:
        - python3
        - -m
        - wyoming_faster_whisper
        - --model
        - tiny
        - --uri
        - tcp://0.0.0.0:10300
        - --data-dir
        - /data
        - --download-dir
        - /data
        - --device
        - cpu
        - --language
        - en
        - --compute-type
        - int8
        - --beam-size
        - "1"
        
        # Clear environment variables (CPU whisper uses command args)
        env: []
        
        # CPU-only resources
        resources:
          requests:
            memory: "1Gi"
            cpu: "1000m"
          limits:
            memory: "2Gi"
            cpu: "2000m"

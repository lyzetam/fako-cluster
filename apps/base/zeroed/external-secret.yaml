apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: zeroed-external-secret
  namespace: zeroed
spec:
  secretStoreRef:
    name: aws-secrets-store
    kind: SecretStore
  target:
    name: zeroed-secrets
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        SUPABASE_URL: "{{ .supabase_url }}"
        SUPABASE_SERVICE_KEY: "{{ .supabase_service_role_key }}"
        NEXT_PUBLIC_SUPABASE_URL: "{{ .supabase_url }}"
        NEXT_PUBLIC_SUPABASE_ANON_KEY: "{{ .supabase_anon_key }}"
        METHOD_API_KEY: "{{ .method_api_key }}"
  data:
    - secretKey: supabase_url
      remoteRef:
        key: zeroed/supabase
        property: url
    - secretKey: supabase_anon_key
      remoteRef:
        key: zeroed/supabase
        property: anon_key
    - secretKey: supabase_service_role_key
      remoteRef:
        key: zeroed/supabase
        property: service_role_key
    - secretKey: method_api_key
      remoteRef:
        key: zeroed/method
        property: api_key
  refreshInterval: 1h

# apps/base/pgadmin/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: pgadmin-config
  namespace: pgadmin
data:
  # PGADMIN_DEFAULT_EMAIL moved to AWS Secrets Manager: /fako/pgadmin/config
  PGADMIN_CONFIG_ENHANCED_COOKIE_PROTECTION: "False"
  PGADMIN_CONFIG_CONSOLE_LOG_LEVEL: "10"
  PGADMIN_CONFIG_SERVER_MODE: "False"
  PGADMIN_CONFIG_MASTER_PASSWORD_REQUIRED: "False"
  # This is important for auto-loading servers
  PGADMIN_SERVER_JSON_FILE: "/pgadmin4/servers.json"
  
  # Pre-configure PostgreSQL servers
  servers.json: |
    {
      "Servers": {
        "1": {
          "Name": "PostgreSQL Cluster",
          "Group": "Servers",
          "Host": "postgres-cluster-rw.postgres.svc.cluster.local",
          "Port": 5432,
          "MaintenanceDB": "postgres",
          "Username": "postgres",
          "SSLMode": "prefer"
        },
        "2": {
          "Name": "PostgreSQL Cluster (app user)",
          "Group": "Servers",
          "Host": "postgres-cluster-rw.postgres.svc.cluster.local",
          "Port": 5432,
          "MaintenanceDB": "n8n",
          "Username": "app",
          "SSLMode": "prefer"
        }
      }
    }

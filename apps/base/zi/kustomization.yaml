apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: zi

resources:
  # Core zI resources
  - namespace.yaml
  - configmap.yaml
  - deployment.yaml
  - service.yaml
  - ingress.yaml
  - pvc.yaml
  - zi-brain-storage.yaml
  - rbac.yaml
  # Dashboard (Next.js)
  - zi-dashboard-deployment.yaml
  - zi-dashboard-service.yaml
  # Shared infrastructure
  - aws-secret-store.yaml
  - external-secret.yaml
  - external-secret-dockerhub.yaml
  - external-secret-langfuse.yaml
  # Redis (cache for agent knowledge sharing)
  - redis-deployment.yaml
  - redis-service.yaml
  # Autobots workforce (merged from autobots base)
  - autobots-deployment.yaml
  - autobots-service.yaml
  - autobots-ingress.yaml
  - autobots-external-secret.yaml

  # Agent Memory PVCs (5 active agents)
  - backend-engineer-memory.yaml
  - code-reviewer-memory.yaml
  - devops-engineer-memory.yaml
  - k8s-engineer-memory.yaml
  - platform-sre-memory.yaml

  # Agent shared resources
  - zi-agents-memory-pvc.yaml
  - rbac-k8s-operator.yaml
  - configmap-generators.yaml

  # Agent deployments (5 active agents)
  - deployments/backend-engineer.yaml
  - deployments/code-reviewer.yaml
  - deployments/devops-engineer.yaml
  - deployments/k8s-engineer.yaml
  - deployments/platform-sre.yaml

  # Agent services (5 active agents)
  - services/backend-engineer.yaml
  - services/code-reviewer.yaml
  - services/devops-engineer.yaml
  - services/k8s-engineer.yaml
  - services/platform-sre.yaml

# Use labels instead of commonLabels to avoid corrupting network policy selectors
labels:
  - pairs:
      app.kubernetes.io/name: zi
      app.kubernetes.io/component: ai-interface
      app.kubernetes.io/part-of: claude-agent-platform
    includeSelectors: false

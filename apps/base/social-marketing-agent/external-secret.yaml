apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: social-marketing-external-secret
  namespace: social-marketing-agent
spec:
  secretStoreRef:
    name: aws-secrets-store
    kind: SecretStore
  target:
    name: agents-secrets
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        ANTHROPIC_API_KEY: "{{ .anthropic_api_key }}"
        TWITTER_BEARER_TOKEN: "{{ .twitter_bearer_token }}"
        TWITTER_API_KEY: "{{ .twitter_api_key }}"
        TWITTER_API_SECRET: "{{ .twitter_api_secret }}"
        TWITTER_ACCESS_TOKEN: "{{ .twitter_access_token }}"
        TWITTER_ACCESS_TOKEN_SECRET: "{{ .twitter_access_token_secret }}"
        LINKEDIN_ACCESS_TOKEN: "{{ .linkedin_access_token }}"
        LINKEDIN_CLIENT_ID: "{{ .linkedin_client_id }}"
        LINKEDIN_CLIENT_SECRET: "{{ .linkedin_client_secret }}"
        INSTAGRAM_ACCESS_TOKEN: "{{ .instagram_access_token }}"
        INSTAGRAM_BUSINESS_ID: "{{ .instagram_business_id }}"
  data:
    # Anthropic API Key for Claude
    - secretKey: anthropic_api_key
      remoteRef:
        key: social-marketing/api-keys
        property: ANTHROPIC_API_KEY
    # Twitter/X API credentials
    - secretKey: twitter_bearer_token
      remoteRef:
        key: social-marketing/twitter
        property: BEARER_TOKEN
    - secretKey: twitter_api_key
      remoteRef:
        key: social-marketing/twitter
        property: API_KEY
    - secretKey: twitter_api_secret
      remoteRef:
        key: social-marketing/twitter
        property: API_SECRET
    - secretKey: twitter_access_token
      remoteRef:
        key: social-marketing/twitter
        property: ACCESS_TOKEN
    - secretKey: twitter_access_token_secret
      remoteRef:
        key: social-marketing/twitter
        property: ACCESS_TOKEN_SECRET
    # LinkedIn API credentials
    - secretKey: linkedin_access_token
      remoteRef:
        key: social-marketing/linkedin
        property: ACCESS_TOKEN
    - secretKey: linkedin_client_id
      remoteRef:
        key: social-marketing/linkedin
        property: CLIENT_ID
    - secretKey: linkedin_client_secret
      remoteRef:
        key: social-marketing/linkedin
        property: CLIENT_SECRET
    # Instagram API credentials
    - secretKey: instagram_access_token
      remoteRef:
        key: social-marketing/instagram
        property: ACCESS_TOKEN
    - secretKey: instagram_business_id
      remoteRef:
        key: social-marketing/instagram
        property: BUSINESS_ID
  refreshInterval: 1h

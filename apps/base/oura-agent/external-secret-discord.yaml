apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: discord-credentials
  namespace: oura-agent
spec:
  secretStoreRef:
    name: aws-secret-store
    kind: SecretStore
  target:
    name: discord-credentials-env
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        DISCORD_BOT_TOKEN: "{{ .bot_token }}"
        DISCORD_GUILD_ID: "{{ .guild_id }}"
        DISCORD_HEALTH_CHANNEL_ID: "{{ .health_channel_id }}"
  data:
  - secretKey: bot_token
    remoteRef:
      key: oura-agent/discord
      property: bot_token
  - secretKey: guild_id
    remoteRef:
      key: oura-agent/discord
      property: guild_id
  - secretKey: health_channel_id
    remoteRef:
      key: oura-agent/discord
      property: health_channel_id
  refreshInterval: 1h

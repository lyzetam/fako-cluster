# # infrastructure/controllers/base/gpu-operator/repository.yaml
# apiVersion: source.toolkit.fluxcd.io/v1
# kind: HelmRepository
# metadata:
#   name: nvidia
#   namespace: gpu-operator
# spec:
#   interval: 24h
#   url: https://helm.ngc.nvidia.com/nvidia

apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: nvidia-device-plugin
  namespace: kube-system
spec:
  chart: nvidia-device-plugin
  repo: https://nvidia.github.io/k8s-device-plugin
  set:
    runtimeClassName: "nvidia"  # Critical for K3s
    compatWithCPUManager: true
    deviceListStrategy: "envvar"
    deviceIDStrategy: "uuid"
    failOnInitError: false
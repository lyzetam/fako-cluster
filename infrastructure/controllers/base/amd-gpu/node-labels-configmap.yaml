apiVersion: v1
kind: ConfigMap
metadata:
  name: node-labels-script
  namespace: gpu-system
data:
  label-nodes.sh: |
    #!/bin/bash
    # Script to label nodes - will be run by a Job
    
    # Label the pgbee node
    kubectl label nodes pgbee accelerator=amd-gpu --overwrite
    kubectl label nodes pgbee gpu.type=amd-apu --overwrite
    kubectl label nodes pgbee gpu.model=renoir --overwrite
    kubectl label nodes pgbee cpu.type=ryzen --overwrite
    kubectl label nodes pgbee hardware.tier=high-performance --overwrite
    kubectl label nodes pgbee node-role.kubernetes.io/gpu-worker=true --overwrite
    kubectl label nodes pgbee compute.capability=opencl-1.1 --overwrite
    kubectl label nodes pgbee compute.units=8 --overwrite
    kubectl label nodes pgbee workload.type=ai-ml --overwrite
    
    # Optional: Add taints (uncomment if needed)
    # kubectl taint nodes pgbee gpu=amd:NoSchedule --overwrite
    # kubectl taint nodes pgbee high-performance=true:PreferNoSchedule --overwrite
    
    echo "Node labeling complete"
    kubectl get nodes pgbee --show-labels
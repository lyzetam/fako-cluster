apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: nfs-config-secret
  namespace: infrastructure
spec:
  secretStoreRef:
    name: aws-secret-store
    kind: SecretStore
  target:
    name: nfs-config
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        NFS_SERVER: "{{ .server }}"
        NFS_STORAGE_PATH: "{{ .storage_path }}"
        NFS_DB_PATH: "{{ .db_path }}"
        NFS_BACKUP_PATH: "{{ .backup_path }}"
  data:
  - secretKey: server
    remoteRef:
      key: infrastructure/nfs-config
      property: server
  - secretKey: storage_path
    remoteRef:
      key: infrastructure/nfs-config
      property: storage_path
  - secretKey: db_path
    remoteRef:
      key: infrastructure/nfs-config
      property: db_path
  - secretKey: backup_path
    remoteRef:
      key: infrastructure/nfs-config
      property: backup_path
  refreshInterval: 1h

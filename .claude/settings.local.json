{
  "permissions": {
    "allow": [
      "Bash(tree:*)",
      "Bash(kubectl get:*)",
      "Bash(kubectl logs:*)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster push)",
      "Bash(kubectl exec:*)",
      "Bash(xargs:*)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster status)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster diff apps/base/audio-compressor/cronjob.yaml)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster log --oneline -5)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster add apps/base/audio-compressor/cronjob.yaml)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nfeat: change audio-compressor output format to mp3\n\nSwitch from WAV to MP3 format to significantly reduce compressed file sizes\nwhile maintaining speech quality for transcription.\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(flux reconcile source git:*)",
      "Bash(flux reconcile kustomization:*)",
      "Bash(kubectl run:*)",
      "mcp__MCP_DOCKER__fetch",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster add:*)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nchore: update n8n to 1.123.0 and add gitops hook\n\n- Update n8n image from 1.119.0 to 1.123.0\n- Add PostToolUse hook to auto-reconcile Flux after git push\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(python3:*)",
      "Bash(kubectl describe:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push)",
      "mcp__MCP_DOCKER__obsidian_list_files_in_vault",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nfeat: add n3xis Manufacturing OEE Platform\n\nDeploy n3xis dashboard to shopflor.n3xis.com with:\n- 2 replicas for high availability\n- Traefik ingress with Let''s Encrypt TLS\n- Health checks on /api/health endpoint\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nfix: add imagePullPolicy Always for n3xis\n\nEnsures latest image is always pulled on deployment to support\nfrequent updates during development.\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(flux get kustomization:*)",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nfix: add staging overlay for n3xis\n\nAdd missing staging kustomization to reference base/n3xis.\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "mcp__MCP_DOCKER__kubectl_get",
      "Bash(git -C /Users/zz/Documents/GitHub/fako-cluster commit -m \"$(cat <<''EOF''\nfeat: add Docker Hub credentials for n3xis private image\n\n- Add SOPS-encrypted dockerhub-credentials secret\n- Add Job to create docker-registry secret from credentials\n- Add imagePullSecrets to deployment\n\n Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "mcp__MCP_DOCKER__kubectl_rollout",
      "mcp__MCP_DOCKER__brave_web_search",
      "Bash(sops -d:*)",
      "Bash(cat:*)"
    ],
    "deny": [],
    "ask": []
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -q 'git.*push'; then echo '[GitOps] Running Flux reconciliation...' && flux reconcile source git flux-system && flux reconcile kustomization apps; fi"
          }
        ]
      }
    ]
  }
}
